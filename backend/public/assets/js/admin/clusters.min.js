!function(){var o="fd-action",n="fd-id",t=".js-clusters-table",e="#js-modal",d="#fd-cluster-code",l="#fd-cluster-id",s="#fd-cluster-name",a="#js-modal-content",i="#js-modal-submit",r="#js-modal-title",c={},u="",f="",p="",m="",b="",v=window.BASE_URL+"/api/clusters/create",h=window.BASE_URL+"/api/clusters/delete/{id}",y=window.BASE_URL+"/api/clusters/{id}",g=window.BASE_URL+"/api/clusters/update/{id}",w=window.BASE_URL+"/api/clusters/";function j(e,t){!function(e){void 0===e&&(e="");u=e}(t.data(o)),A(t.data(n)),(0,{create:C,update:x,delete:E}[u])()}function C(){b="Create a new cluster",p=T(),m='<i class="fa fa-plus"></i>&nbsp;Create',P()}function x(){z({url:y.replace("{id}",f),onSuccess:function(e){L(e),b="Update cluster <strong>"+c.label+"</strong>",p=T(),m='<i class="fa fa-pencil"></i>&nbsp;Update',P()}})}function E(){z({url:y.replace("{id}",f),onSuccess:function(e){L(e),b="Delete cluster <strong>"+c.label+"</strong>",p=T(),m='<i class="fa fa-trash"></i>&nbsp;Delete',P()}})}function S(e){var t,o,n;t=b,$(r).html(t),o=p,$(a).html(o),n=m,$(i).html(n)}function U(e){"create"===u&&$(l).focus()}function D(e){var t,o,n,a={create:"fd:create-cluster",update:"fd:update-cluster",delete:"fd:delete-cluster"}[u];$(document).trigger(a,[(t=$(l),o=$(s),n=$(d),{id:"P"===t.prop("nodeName")?t.text():t.val(),name:"P"===o.prop("nodeName")?o.text():o.val(),code:"P"===n.prop("nodeName")?n.text():n.val()})])}function N(e,t){L(t),A(t.id),R(v,t)}function B(e,t){R(g.replace("{id}",f),t)}function _(e,t){R(h.replace("{id}",f),t)}function R(e,t){z({url:e,type:"post",data:t,onSuccess:function(e){var t;F(),t=e.message,FoWDB.clearNotifications().notify(t,"info"),$(document).trigger("fd:update-list")},onError:function(e){var t;F(),t=e.message,FoWDB.clearNotifications().notify(t,"danger")}})}function k(e){z({url:w,type:"get",onSuccess:function(e){html=e.reduce(function(e,t){return e+=function(e){var t=["btn","btn-xs","fd-btn-default","fd-btn-warning-hover","js-open-modal"].join(" "),o=["btn","btn-xs","fd-btn-default","fd-btn-danger-hover","js-open-modal"].join(" "),n="";if(e.id==f)switch(u){case"create":n='<span class="label label-success">NEW</span>';break;case"update":n='<span class="label label-warning">UPD</span>'}return["<tr>","<td>",e.id,"</td>","<td>","<button ",'type="button" ','class="',t,'" ','data-fd-action="update"','data-fd-id="',e.id,'"',">",'<i class="fa fa-pencil"></i>&nbsp;',"Update","</button>&nbsp;","<button ",'type="button" ','class="',o,'" ','data-fd-action="delete"','data-fd-id="',e.id,'"',">",'<i class="fa fa-trash"></i>&nbsp;',"Delete","</button>","</td>","<td>",n,"&nbsp;",e.name,"</td>","<td>",e.code,"</td>","</tr>"].join("")}(t)},""),$(t).empty().html(html)}})}function A(e){void 0===e&&(e=""),f=e}function L(e){void 0===e?e={}:e.label=["#"+e.id,e.name,"("+e.code.toUpperCase()+")"].join(" "),c=e}function P(){$(e).modal("show")}function F(){$(e).modal("hide")}function T(){var e="create"===u,t="delete"===u;return['<div class="row">','<div class="col-xs-12">','<form class="form-horizontal">',W({label:"ID",type:"number",id:l.substr(1),placeholder:!!e&&"Cluster ID...",value:!e&&c.id,readonly:!e}),W({label:"Name",type:"text",id:s.substr(1),placeholder:!!e&&'Cluster Name Ex.: "Dope Cluster"...',value:!e&&c.name,readonly:t}),W({label:"Code",type:"text",id:d.substr(1),placeholder:!!e&&"Cluster Code...",value:!e&&c.code,readonly:t}),"</form>","</div>","</div>"].join("")}function W(e){e.value=e.value||"",e.readonly=e.readonly||!1;var t,o;return['<div class="form-group">','<div class="col-sm-2 control-label">',e.label,"</div>",'<div class="col-sm-10">',e.readonly?(o=e,["<p ",'class="fd-text-form-horizontal font-110" ','id="',o.id,'"',">",o.value,"</p>"].join("")):(t=e,["<input ",'type="',t.type,'" ','id="',t.id,'" ','class="form-control font-110"',t.placeholder?'placeholder="'+t.placeholder+'" ':"",t.value?'value="'+t.value+'"':"",">"].join("")),"</div>","</div>"].join("")}function z(t){var e={};if(void 0===t.data&&(t.data={}),void 0===t.type&&(t.type="get"),"get"!==t.type){var o=$('meta[name="_token"]').attr("content");t.data._token=o,e.headers={"X-CSRF-TOKEN":o}}void 0===t.onError&&(t.onError=function(e){console.log(e.message)}),void 0===t.onComplete&&(t.onComplete=function(){}),e.url=t.url,e.type=t.type.toUpperCase(),e.dataType="json",e.data=t.data,e.success=function(e){e.error?t.onError(e):t.onSuccess(e),t.onComplete()},e.error=function(e,t,o){console.log(e.responseText,t,o)},jQuery.ajax(e)}$(document).ready(function(){$(document).on("click",".js-open-modal",function(){$(document).trigger("fd:show-modal",[$(this)])}).on("click",i,function(){$(document).trigger("fd:submit-modal",[$(this)])}).on("fd:show-modal",j).on("fd:submit-modal",D).on("fd:create-cluster",N).on("fd:update-cluster",B).on("fd:delete-cluster",_).on("fd:update-list",k).on("show.bs.modal",S).on("shown.bs.modal",U)})}();